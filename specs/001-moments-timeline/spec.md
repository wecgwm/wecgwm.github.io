# Feature Specification: 时刻记录（Moments Timeline）

**Feature Branch**: `001-moments-timeline`
**Created**: 2025-11-11
**Status**: Draft
**Input**: User description: "我想为这个博客新增一个功能（可以是新的页面也可以是在原有的关于页），该功能的灵感来自https://sepia.v2ex.pro/，核心需求有两点1.记录某个时刻的灵感/随想，具备时间戳 2.方便更新"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 浏览时刻记录 (Priority: P1)

作为博客读者，我想要浏览博主发布的灵感和随想，了解博主的思考片段和日常记录，这样我可以更全面地了解博主的思维方式和生活状态。

**Why this priority**: 这是核心功能的基础。如果读者无法查看内容，这个功能就失去了意义。这是 MVP 的最小可交付单元。

**Independent Test**: 可以通过访问专门的"时刻"页面或在关于页查看时刻列表，验证能否看到至少一条带时间戳的记录来完全测试此功能。

**Acceptance Scenarios**:

1. **Given** 博客已发布至少一条时刻记录，**When** 读者访问时刻页面，**Then** 应该看到按时间倒序排列的记录列表
2. **Given** 每条时刻记录都有时间戳，**When** 读者查看列表，**Then** 每条记录旁边都应显示发布的具体时间（如"2025-11-11 14:30"或"2小时前"）
3. **Given** 时刻列表中有多条记录，**When** 读者滚动页面，**Then** 应该能够流畅查看所有历史记录
4. **Given** 时刻记录可能包含文字、链接，**When** 读者查看单条记录，**Then** 内容应该清晰可读且链接可点击

---

### User Story 2 - 快速发布新时刻 (Priority: P2)

作为博客作者，我想要快速记录当前的灵感或想法，不需要经过复杂的流程，这样我可以及时捕捉转瞬即逝的思考。

**Why this priority**: 这是"方便更新"需求的核心体现。没有便捷的发布方式，作者会失去记录灵感的动力，导致功能闲置。

**Independent Test**: 可以通过模拟作者从产生想法到内容发布上线的完整流程，测量整个过程是否在 5 分钟内完成（包括内容编辑和部署）。

**Acceptance Scenarios**:

1. **Given** 作者有一个灵感需要记录，**When** 作者在 GitHub 仓库创建新 Issue 并打上 `moment` 标签，**Then** 应该能在 2 分钟内完成内容编辑和提交
2. **Given** 新 Issue 已创建，**When** GitHub Actions 检测到事件并执行同步，**Then** 系统应自动从 Issue 的 `created_at` 字段获取时间戳
3. **Given** Issue 内容使用 Markdown 格式编写，**When** 作者编辑时，**Then** 应该支持基本的格式化（粗体、斜体、链接）
4. **Given** Actions 工作流执行完成，**When** 博客重新部署后，**Then** 新时刻应立即出现在列表顶部

---

### User Story 3 - 编辑和删除已发布时刻 (Priority: P3)

作为博客作者，我想要修改或删除之前发布的时刻记录，纠正错别字或移除不再合适的内容，这样我可以保持时刻记录的质量和准确性。

**Why this priority**: 这是内容管理的基本需求，但不是 MVP 的阻塞项。即使暂时无法修改，作者仍然可以发布新内容来补充或说明。

**Independent Test**: 可以通过创建一条测试记录，然后修改其内容并验证修改生效，最后删除该记录并确认其从列表中消失，来完整测试此功能。

**Acceptance Scenarios**:

1. **Given** 已存在一条时刻记录（对应一个 Issue），**When** 作者在 GitHub 编辑该 Issue，**Then** 应该能够修改内容并保存
2. **Given** Issue 被编辑，**When** GitHub Actions 同步更新，**Then** 应保持原始 `created_at` 时间戳不变，但记录 `updated_at` 作为编辑时间
3. **Given** 作者决定删除某条时刻，**When** 作者关闭对应的 Issue，**Then** 该记录应从时刻列表中移除（但 Issue 本身保留在 GitHub）
4. **Given** 时刻记录可能被其他页面引用，**When** 删除（关闭）Issue 时，**Then** GitHub 界面会有确认提示避免误操作

---

### Edge Cases

- **空状态处理**：当还没有任何带 `moment` 标签的 Issue 时，页面应显示友好的空状态提示（如"还没有记录任何时刻"）而不是空白页面
- **超长内容**：单条时刻的文字内容过长（超过 500 字）时，如何显示？是否需要截断或折叠？
- **时间戳格式**：对于不同时间范围的记录（今天、昨天、本周、更早），时间戳应如何显示才能保持一致性和可读性？
- **Actions 执行失败**：如果 GitHub Actions 工作流执行失败，如何通知作者？是否需要重试机制？
- **API 限流**：GitHub API 有访问频率限制，如果短时间内创建多个 Issue，是否会触发限流？
- **特殊字符处理**：Issue 内容包含特殊 Markdown 字符或 HTML 标签时，是否能正确转义和显示？
- **Issue 误标记**：如果作者意外给普通 Issue 打上 `moment` 标签，如何处理？是否需要验证机制？

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须提供一个专门的页面用于展示所有时刻记录（或在现有关于页集成展示区域）
- **FR-002**: 系统必须按发布时间倒序（最新的在最前）排列时刻记录
- **FR-003**: 每条时刻记录必须显示精确的时间戳信息（包含日期和时间）
- **FR-004**: 时刻记录必须支持富文本内容（至少支持链接、粗体、斜体等基本 Markdown 格式）
- **FR-005**: 作者必须能够通过 GitHub Issues 界面快速添加新的时刻记录（在任何设备上通过浏览器或 GitHub App 操作）
- **FR-006**: 系统必须在发布时自动生成或记录时间戳，无需作者手动输入
- **FR-007**: 时刻记录的内容必须持久化存储，在博客重新构建后不丢失
- **FR-008**: 时刻记录必须在博客导航中有明确的入口，读者能轻松找到
- **FR-009**: 每条时刻记录必须有唯一标识，支持未来的编辑和删除操作
- **FR-010**: 时刻页面必须与博客整体设计风格保持一致

### Key Entities

- **时刻记录（Moment）**: 表示某个时间点发布的灵感或随想，对应一个 GitHub Issue
  - 关键属性：Issue 编号（唯一标识）、Issue 标题、Issue 内容、发布时间戳（created_at）、编辑时间戳（updated_at）、状态（open/closed）
  - 内容使用 Markdown 格式编写，支持链接、格式化等
  - 每条记录独立存在，不依赖其他记录
  - 只有打上 `moment` 标签且状态为 open 的 Issue 才会被展示

- **时间戳（Timestamp）**: 记录发布或修改的精确时间，来自 GitHub Issue 的元数据
  - 包含日期和时间信息（GitHub API 提供 ISO 8601 格式）
  - `created_at`: 用于排序和显示发布时间
  - `updated_at`: 用于显示最后编辑时间
  - 完全由 GitHub 自动生成和管理，不可手动修改（保证真实性）

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 读者可以在 3 次点击内从博客首页访问到时刻记录页面
- **SC-002**: 作者可以在 5 分钟内完成从编辑新时刻到发布上线的完整流程
- **SC-003**: 时刻页面加载时间不超过 2 秒（在标准网络条件下）
- **SC-004**: 时刻记录列表可以正确显示至少 100 条记录而不影响页面性能
- **SC-005**: 每条时刻记录的时间戳格式统一且清晰易读（如"2025-11-11 14:30"或"2小时前"）
- **SC-006**: 读者在浏览时刻记录时，内容的可读性评分达到良好水平（字体大小合适、行距舒适、对比度足够）

## Assumptions *(optional)*

以下假设基于 GitHub Issues 作为数据源的实现方案：

1. **更新方式**：作者通过在 GitHub 仓库创建 Issue 的方式发布时刻记录（使用特定标签如 `moment` 进行标识）
2. **数据同步机制**：使用 GitHub Actions 自动监听 Issue 事件（创建、编辑、关闭），并将数据同步到博客数据文件
3. **存储方式**：时刻记录数据从 Issues 提取后存储为 JSON/YAML 文件，由 Hexo 在构建时读取并渲染
4. **时间戳来源**：时间戳来自 GitHub Issue 的 `created_at` 字段（由 GitHub API 提供），编辑时间来自 `updated_at` 字段
5. **Issue 标签规范**：只有打上 `moment` 标签的 Issue 才会被识别为时刻记录；关闭的 Issue 不会在页面显示
6. **分页假设**：如果时刻记录超过 50 条，采用分页或无限滚动加载的方式展示，避免单页面加载过多内容
7. **访问权限假设**：时刻记录对所有访客公开可见，不需要登录或权限控制
8. **响应式设计假设**：时刻页面需要适配桌面和移动设备，确保在不同屏幕尺寸下都有良好体验
9. **GitHub 依赖**：功能依赖 GitHub Issues API 和 GitHub Actions 的可用性和稳定性

## Out of Scope *(optional)*

以下功能明确不包含在本次实现范围内：

1. **评论功能**：读者不能对单条时刻记录进行评论或互动
2. **分类和标签**：时刻记录不支持按主题、标签或分类筛选
3. **搜索功能**：不提供站内搜索时刻内容的能力
4. **RSS 订阅**：时刻记录不生成单独的 RSS feed
5. **社交分享**：不提供分享单条时刻到社交媒体的功能
6. **多媒体内容**：不支持直接嵌入图片、视频或音频（可通过外部链接引用）
7. **富文本编辑器**：不提供所见即所得的编辑界面，仅支持 Markdown 文本编辑
8. **版本历史**：不记录时刻记录的修改历史（除非依赖 Git 历史）

## Dependencies *(optional)*

- **GitHub Issues API**：功能依赖 GitHub Issues 作为数据源，需要稳定的 API 访问
- **GitHub Actions**：依赖 GitHub Actions 自动化工作流来同步 Issue 数据到仓库
- **Hexo 构建系统**：功能依赖 Hexo 的页面生成和渲染能力
- **主题兼容性**：需要确保当前使用的 Fluid 主题能够支持自定义页面或需要进行主题修改
- **网络连接**：GitHub Actions 执行依赖网络连接到 GitHub API
